<div class="container">
  <% creator = User.find_by_id(@offer.creator_id) %>
  <% @user = User.find(@offer.creator_id) %>
  <div class="row">
    <div class="col">
      <%= render "connection_chain" %>
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nihil sed reprehenderit quidem sit voluptates iusto voluptate quia sint, voluptas impedit quam, amet consequatur sunt non assumenda libero cumque magnam eligendi.</p>
    </div>
    <div class="col">
      <div class="chatroom">
        <% @user = User.find(@offer.creator_id) %>
        <div>
          <% if @offer.status === "pending" %>
            <div id="messages" data-chatroom-id="<%= @offer.id %>">
              <i class="author">
                <span><%= @user.first_name%></span>
                <small><%= @offer.created_at.strftime("%a %b %e at %l:%M%p") %></small>
              </i>
              <p><%= @offer.first_message %></p>

              <%= simple_form_for [ @offer, @message ], remote: true do |f| %>
                <%= f.input :content, label: false %>
                <div class="d-flex" style="justify-content: flex-end; margin-top: 8px;">
                  <button value="declined" name="status" class="btn-offer btn-danger btn-lg white-link" style="justify-content: flex-end;">Decline</button>
                  <button value="accepted" name="status" class="btn-offer btn-success btn-lg white-link" style="justify-content: flex-end; margin-left: 4px">Accept</button>
                </div>
              <% end %>
            </div>
          </div>
        </div>
          <% elsif @offer.status === "declined"%>
            <div id="messages" data-chatroom-id="<%= @offer.id %>">
              <i class="author">
                <span><%= @user.first_name%></span>
                <small><%= @offer.created_at.strftime("%a %b %e at %l:%M%p") %></small>
              </i>
              <p><%= @offer.first_message %></p>
              <% @offer.messages.each do |message| %>
                <%= render "messages/message", message: message %>
              <% end %>
            </div>
            <p>THe offer was declined</p>
          <% elsif @offer.status === "accepted" %>
            <div id="messages" data-chatroom-id="<%= @offer.id %>">
              <i class="author">
                <span><%= @user.first_name%></span>
                <small><%= @offer.created_at.strftime("%a %b %e at %l:%M%p") %></small>
              </i>
              <p>Initial Message: <%= @offer.first_message %></p>
              <% @offer.messages.each do |message| %>
                <%= render "messages/message", message: message %>
              <% end %>
            </div>
          <% end %>

          <% if @offer.status == "accepted" %>
            <%= simple_form_for [ @offer, @message ], remote: true do |f| %>
              <%= f.input :content, label: false %>
              <%= f.button :submit, "Send Message", class: "btn btn-message" %>
            <% end %>
          <% end %>

          <% if @offer.status.nil? %>
            <%= simple_form_for [ @offer, @message ], remote: true do |f| %>
              <%= f.input :content, label: false %>
              <%= f.button :submit, "Send Message", class: "btn btn-message" %>
            <% end %>
          <% end %>

        </div>
      </div>
    </div>
  </div>
</div>

